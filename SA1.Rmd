---
title: "SA1"
author: "Awit, Julia Theressa and Deloyola, Jhen Reyniel L."
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Exercise 2: Discrete Random Variables

```{r}
# Function to validate probability distribution
validate_probs <- function(probs) {
  return(all(probs >= 0 & probs <= 1) && sum(probs) == 1)
}

# Univariate discrete random variable
x_values <- c(1, 2, 3, 4, 5)
probs <- c(0.1, 0.2, 0.3, 0.2, 0.2)

if (validate_probs(probs)) {
  mean_x <- sum(x_values * probs)
  var_x <- sum(((x_values - mean_x)^2) * probs)
  cat("Mean:", mean_x, "\nVariance:", var_x, "\n")
} else {
  stop("Invalid probability distribution")
}
```

## Bivariate Discrete Random Variables

```{r}
# Defining bivariate probability distribution
x_vals <- c(1, 2)
y_vals <- c(1, 2)
prob_matrix <- matrix(c(0.2, 0.3, 0.1, 0.4), nrow = 2, byrow = TRUE)

# Marginal distributions
px <- rowSums(prob_matrix)
py <- colSums(prob_matrix)

# Conditional probabilities
p_y_given_x <- prob_matrix / px

cat("Marginal P(X):", px, "\n")
cat("Marginal P(Y):", py, "\n")
cat("Conditional P(Y | X):\n")
print(p_y_given_x)
```

## Exercise 3: Simulation Experiment

```{r}
set.seed(123)
n_searches <- 10000
p <- 0.6 # Probability of finding the key phrase
searches <- rgeom(n_searches, prob = p) + 1

# Simulated PDF
hist(searches, probability = TRUE, main = "Simulated PDF", xlab = "Searches", col = "pink", border = "black")

# Mean and variance
mean_searches <- mean(searches)
var_searches <- var(searches)
cat("Mean:", mean_searches, "\nVariance:", var_searches, "\n")
```

## Conditional Probability

```{r}
cond_searches <- searches[searches > 3]
prob_x4_given_x3 <- mean(cond_searches == 4)
prob_x5_given_x3 <- mean(cond_searches == 5)
prob_x1 <- mean(searches == 1)
prob_x2 <- mean(searches == 2)

cat("P(X=4 | X>3):", prob_x4_given_x3, "\nP(X=1):", prob_x1, "\n")
cat("P(X=5 | X>3):", prob_x5_given_x3, "\nP(X=2):", prob_x2, "\n")